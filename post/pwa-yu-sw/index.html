<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    é›å—é£æ— ç•™æ„
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="é›å—é£æ— ç•™æ„">
<meta name="description" content="ç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰,å…¶æ¬¡æ˜¯ç°åœ¨ã€‚o(*ï¿£â–½ï¿£*)ãƒ–">
<meta name="keywords" content="ä¸ªäººåšå®¢">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://2022FuGui.github.io/styles/main.css" />
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                <!--ç‚¹å‡»ç‰¹æ•ˆ-->
                <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/love.min.js"></script>
                
                        <!--CDNæ ·å¼-->
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://2022FuGui.github.io">
                    é›å—é£æ— ç•™æ„
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        é¦–é¡µ
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        æ–‡ç« 
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        æ ‡ç­¾
                    </a>
                    
                    <a class="menu-item" href="https://2022FuGui.github.io/post/about">
                        å…³äºæœ¬ç«™
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1729699091091" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://2022FuGui.github.io">
                            é›å—é£æ— ç•™æ„
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1729699091091" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            é¦–é¡µ
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            æ–‡ç« 
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            æ ‡ç­¾
                        </a>
                        
                        <a class="menu-item" href="https://2022FuGui.github.io/post/about">
                            å…³äºæœ¬ç«™
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                PWAä¸SW
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            é›å—é£æ— ç•™æ„
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2023-07-20</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">6.3
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">1564</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://2022FuGui.github.io/tag/-ZR9t8xZLQ/">æ€§èƒ½è°ƒä¼˜</a>
                                
                                <a href="https://2022FuGui.github.io/tag/5d3oKlLxgj/">å‰ç«¯</a>
                                
                            </span>
                                            
                                                é˜…è¯»é‡:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                            <img class="post-feature-image" src="https://2022FuGui.github.io/post-images/pwa-yu-sw.jpg" alt="">
                          
                        <div class="post-content">
                            <h1 id="01-pwaä¸service-workers">01 ã€PWAä¸Service Workersã€‘</h1>
<h2 id="1å‰æœŸä»‹ç»">1.å‰æœŸä»‹ç»</h2>
<h3 id="11-æ¸è¿›å¼-web-åº”ç”¨pwa">1.1 æ¸è¿›å¼ Web åº”ç”¨ï¼ˆPWAï¼‰</h3>
<p>PWAçš„ä¸­æ–‡åå«åš<strong>æ¸è¿›å¼ç½‘é¡µåº”ç”¨</strong>ï¼Œæ—©åœ¨2014å¹´ï¼Œ W3C å…¬å¸ƒè¿‡ <code>Service Worker</code> çš„ç›¸å…³è‰æ¡ˆï¼Œä½†æ˜¯å…¶åœ¨ç”Ÿäº§ç¯å¢ƒè¢« <code>Chrome</code> æ”¯æŒæ˜¯åœ¨ 2015 å¹´ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ PWA çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ <code>Service Worker</code> çš„å‡ºç°ä½œä¸º <code>PWA</code> çš„è¯ç”Ÿæ—¶é—´ï¼Œé‚£å°±åº”è¯¥æ˜¯ 2015 å¹´ã€‚</p>
<!-- more -->
<p>è‡ª 2015 å¹´ä»¥æ¥ï¼Œ<code>PWA</code> ç›¸å…³çš„æŠ€æœ¯ä¸æ–­å‡çº§ä¼˜åŒ–ï¼Œåœ¨ç”¨æˆ·ä½“éªŒå’Œç”¨æˆ·ç•™å­˜ä¸¤æ–¹é¢éƒ½æä¾›äº†éå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆã€‚<code>PWA</code> å¯ä»¥å°† <code>Web</code> å’Œ <code>App</code> å„è‡ªçš„ä¼˜åŠ¿èåˆåœ¨ä¸€èµ·ï¼šæ¸è¿›å¼ã€å¯å“åº”ã€å¯ç¦»çº¿ã€å®ç°ç±»ä¼¼ <code>App</code> çš„äº¤äº’ã€å³æ—¶æ›´æ–°ã€å®‰å…¨ã€å¯ä»¥è¢«æœç´¢å¼•æ“æ£€ç´¢ã€å¯æ¨é€ã€å¯å®‰è£…ã€å¯é“¾æ¥ã€‚</p>
<p><strong>éœ€è¦ç‰¹åˆ«è¯´æ˜çš„æ˜¯ï¼Œ<code>PWA</code> ä¸æ˜¯ç‰¹æŒ‡æŸä¸€é¡¹æŠ€æœ¯ï¼Œè€Œæ˜¯åº”ç”¨äº†å¤šé¡¹æŠ€æœ¯çš„ <code>Web App</code>ã€‚å…¶æ ¸å¿ƒæŠ€æœ¯åŒ…æ‹¬ <code>App Manifest</code>ã€<code>Service Worker</code>ã€<code>Web Push</code>ï¼Œç­‰ç­‰ã€‚</strong></p>
<h3 id="12-ä¸ºä»€ä¹ˆw3cå’Œè°·æ­Œåœ¨æ¨å¹¿è¿™é¡¹æŠ€æœ¯">1.2 ä¸ºä»€ä¹ˆW3Cå’Œè°·æ­Œåœ¨æ¨å¹¿è¿™é¡¹æŠ€æœ¯</h3>
<p>è¿™å°±è¦ä»å‰ç«¯çš„ç°çŠ¶è¯´èµ·ï¼š</p>
<p>Native APP ç”¨èµ·æ¥å¾ˆæµç•…ï¼Œä½†æ˜¯ä¹Ÿæœ‰å…¶å¤©ç„¶çš„åŸºå› ç¼ºé™·ï¼š</p>
<blockquote>
<ul>
<li>ç”±äºå…¶å¤©ç”Ÿå°é—­çš„åŸºå› ï¼Œå†…å®¹æ— æ³•è¢«ç´¢å¼•</li>
<li>ç”¨æˆ· 80% çš„æ—¶é—´è¢« Top3 çš„è¶…çº§ App å æ®ï¼Œå¯¹äºç«™ç‚¹æ¥è¯´ï¼Œåº”ç”¨åˆ†å‘çš„æ€§ä»·æ¯”ä¹Ÿè¶Šæ¥è¶Šä¸åˆ’ç®—</li>
<li>è¦ä½¿ç”¨å®ƒï¼Œé¦–å…ˆè¿˜éœ€è¦ä¸‹è½½å‡ åå…†ä¸Šç™¾ç€å…†çš„å®‰è£…åŒ…</li>
</ul>
</blockquote>
<p>WEBå‰ç«¯è™½ç„¶å¤©ç”Ÿå…·æœ‰å¼€æ”¾çš„åŸºå› ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™é¡µé¢ä¼šå¡é¡¿ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³ã€‚è™½ç„¶ç¤¾åŒºä¹‹å‰ä¹Ÿåšè¿‡å¾ˆå¤šåŠªåŠ›ï¼Œä¾‹å¦‚<code>virtual dom</code>ã€<code>spa</code>ã€æ··åˆç¼–ç¨‹ã€ç”¨<code>canvas</code>å°†æ•´ä¸ªé¡µé¢ç”»å‡ºæ¥ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿæœ‰äº†å¾ˆå¤§çš„æ”¹å–„ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•è§£å†³å‡ ä¸ªé‡è¦çš„é—®é¢˜ï¼š</p>
<blockquote>
<ul>
<li>ç¦»çº¿æ—¶ç”¨æˆ·æ— æ³•ä½¿ç”¨</li>
<li>æ— æ³•æ¥æ”¶æ¶ˆæ¯æ¨é€</li>
<li>ç§»åŠ¨ç«¯æ²¡æœ‰ä¸€çº§å…¥å£</li>
</ul>
</blockquote>
<p>W3Cå’Œè°·æ­Œçœ‹åˆ°äº†è¿™äº›é—®é¢˜ï¼Œäºæ˜¯æ¨å‡ºäº†<code>PWA</code>ã€‚</p>
<h3 id="13-pwaçš„æ ¸å¿ƒç›®æ ‡">1.3 PWAçš„æ ¸å¿ƒç›®æ ‡</h3>
<p><code>PWA</code>çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯æå‡ Web App çš„æ€§èƒ½ï¼Œæ”¹å–„ Web App çš„ç”¨æˆ·ä½“éªŒã€‚åª²ç¾nativeçš„æµç•…ä½“éªŒï¼Œå°†ç½‘ç»œä¹‹é•¿ä¸åº”ç”¨ä¹‹é•¿ç›¸ç»“åˆã€‚</p>
<h2 id="2ç‰¹ç‚¹">2.ç‰¹ç‚¹</h2>
<h3 id="21-ç‰¹ç‚¹">2.1 ç‰¹ç‚¹</h3>
<figure data-type="image" tabindex="1"><img src="https://article.biliimg.com/bfs/article/a42e32b94caafab73155ae12bf16e0af0dc6c853.png" alt="" loading="lazy"></figure>
<p>è¿™è¾¹æœ‰ä¸€ä¸ªå…³äºPWAç‰¹ç‚¹çš„<a href="https://web.dev/pwa-checklist/#exemplary">åˆ—è¡¨æ¸…å•</a>ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç‚¹è¿›å»çœ‹çœ‹.</p>
<h3 id="22-ç‰¹ç‚¹è¯¦è§£">2.2 ç‰¹ç‚¹è¯¦è§£</h3>
<h4 id="å¯å®‰è£…">å¯å®‰è£…</h4>
<ol>
<li>
<p>å¯å®‰è£…æŒ‡çš„æ˜¯å¯ä»¥åƒåŸç”ŸAPPåœ¨ä¸»å±å¹•ä¸Šç•™æœ‰å›¾æ ‡ã€‚</p>
</li>
<li>
<p>ä½†æ˜¯è¿™éœ€è¦æˆ‘ä»¬æä¾› <code>Web app manifest</code>ï¼Œ<code>manifest.json</code> æ˜¯ä¸€ä¸ªç®€å•çš„JSONæ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨ <code>html</code> é¡µé¢å¦‚ä¸‹å¼•ç”¨ä»–ï¼š</p>
<p>å®ƒæè¿°äº†æˆ‘ä»¬çš„å›¾æ ‡åœ¨ä¸»å±å¹•ä¸Šå¦‚ä½•æ˜¾ç¤ºï¼Œä»¥åŠå›¾æ ‡ç‚¹å‡»è¿›å»çš„å¯åŠ¨é¡µæ˜¯ä»€ä¹ˆï¼Œå®ƒçš„JSONæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š<br>
<img src="https://article.biliimg.com/bfs/article/488722e9661d15e8ebacc0f1d13fa72b5005daba.png" alt="" loading="lazy"></p>
<p>å…¶ä¸­ï¼š</p>
<blockquote>
<ul>
<li><code>start_url</code> å¯ä»¥è®¾ç½®å¯åŠ¨ç½‘å€</li>
<li><code>icons</code> ä¼šå¸®æˆ‘ä»¬è®¾ç½®å„ä¸ªåˆ†è¾¨ç‡ä¸‹é¡µé¢çš„å›¾æ ‡</li>
<li><code>background_color</code> ä¼šè®¾ç½®èƒŒæ™¯é¢œè‰²ï¼Œ Chrome åœ¨ç½‘ç»œåº”ç”¨å¯åŠ¨åä¼šç«‹å³ä½¿ç”¨æ­¤é¢œè‰²ï¼Œè¿™ä¸€é¢œè‰²å°†ä¿ç•™åœ¨å±å¹•ä¸Šï¼Œç›´è‡³ç½‘ç»œåº”ç”¨é¦–æ¬¡å‘ˆç°ä¸ºæ­¢ã€‚</li>
<li><code>theme_color</code> ä¼šè®¾ç½®ä¸»é¢˜é¢œè‰²</li>
<li><code>display</code> è®¾ç½®å¯åŠ¨æ ·å¼</li>
</ul>
</blockquote>
</li>
</ol>
<p>â€‹		å…³äº<code>manifest.json</code>é‡Œå­—æ®µæ›´åŠ å…·ä½“çš„å«ä¹‰ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/Manifest">MDNæ–‡æ¡£</a></p>
<h4 id="ç¦»çº¿ä½¿ç”¨">ç¦»çº¿ä½¿ç”¨</h4>
<ol>
<li><code>PWA</code> å¦ä¸€é¡¹ä»¤äººå…´å¥‹çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥ç¦»çº¿ä½¿ç”¨,å…¶èƒŒåç”¨åˆ°çš„æŠ€æœ¯æ˜¯ <code>Service worker</code> ;</li>
<li><code>Service worker</code>å®é™…ä¸Šæ˜¯ä¸€æ®µè„šæœ¬ï¼Œåœ¨åå°è¿è¡Œã€‚ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œè¿è¡Œç¯å¢ƒä¸æ™®é€šè„šæœ¬ä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å‚ä¸ Web äº¤äº’è¡Œä¸ºã€‚<code>Service Worker</code> çš„å‡ºç°æ˜¯æ­£æ˜¯ä¸ºäº†ä½¿å¾— <code>Web App</code> ä¹Ÿå¯ä»¥åšåˆ°åƒ <code>Native App</code> é‚£æ ·å¯ä»¥ç¦»çº¿ä½¿ç”¨ã€æ¶ˆæ¯æ¨é€çš„åŠŸèƒ½ã€‚<br>
æˆ‘ä»¬å¯ä»¥æŠŠ<code>Service worker</code>å½“åšæ˜¯ä¸€ç§å®¢æˆ·ç«¯ä»£ç†ã€‚</li>
<li>å½“ç„¶ <code>Service Worker</code> ä¹Ÿæœ‰ç”Ÿå‘½å‘¨æœŸï¼Œå‚è€ƒä¸‹å›¾ï¼š<br>
<img src="https://article.biliimg.com/bfs/article/f63e2809f1bbcd918f5c1fe8174662242e25b8d0.png" alt="" loading="lazy"></li>
</ol>
<h4 id="æ¶ˆæ¯æ¨é€">æ¶ˆæ¯æ¨é€</h4>
<p>æ¶ˆæ¯æ¨é€å…·ä½“å¯ä»¥å‚è€ƒè°·æ­Œçš„å®˜æ–¹æ•™ç¨‹<a href="https://codelabs.developers.google.com/codelabs/push-notifications">Your First Web Push Notification</a>,é‡Œé¢æœ‰è¯¦ç»†çš„ä»£ç Demoå’Œè¯´æ˜ï¼Œä»¥åŠç›¸åº”çš„åå°é…ç½®ï¼ˆå¸¦å¥½æ¢¯å­ï¼‰ã€‚</p>
<h2 id="3vue3ä¸­å¯¹pwaçš„ä½¿ç”¨">3.vue3ä¸­å¯¹pwaçš„ä½¿ç”¨</h2>
<blockquote>
<ol>
<li>å®‰è£…vite-plugin-pwaæ’ä»¶ pnpm add -D vite-plugin-pwa</li>
<li>åœ¨vite.config.tsé‡Œå¯¼å…¥</li>
<li>åœ¨pluginsé‡Œé…ç½®</li>
<li>åœ¨main.jsæ³¨å†Œswå‘Šè¯‰æµè§ˆå™¨å¼€è¾Ÿä¸€å—ç¼“å­˜åŒºåŸŸ</li>
<li>åœ¨srcä¸‹æ–°å»ºservice-worker.jsæ–‡ä»¶</li>
</ol>
</blockquote>
<h3 id="31-viteconfigts">3.1 <code>vite.config.ts</code></h3>
<pre><code class="language-ts">import { VitePWA } from 'vite-plugin-pwa'

plugins:[VitePWA({
      strategies: 'injectManifest',
      injectRegister: false,
      srcDir: 'src',
      filename: 'service-worker.js',
      devOptions: {
        enabled: true,
        /* other options */
      },
      injectManifest: {
        injectionPoint: undefined,
      },
      // workbox: {
      //   globPatterns: ['**/*.{js,css,ico,png,svg}'],
      // },
      manifest: {
        name: 'chatGPTdemo',
        short_name: 'chatGPTdemo',
        icons: [
          { src: 'pwa-192x192.png', sizes: '192x192', type: 'image/png' },
          { src: 'pwa-512x512.png', sizes: '512x512', type: 'image/png' },
        ],
      },
    })]
</code></pre>
<h3 id="32-maints">3.2 <code>main.ts</code></h3>
<pre><code class="language-ts">if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register(
    import.meta.env.MODE === 'production' ? '/service-worker.js' : '/dev-sw.js?dev-sw',
  )
}
</code></pre>
<h3 id="33-service-workerjs">3.3 <code>service-worker.js</code></h3>
<p>å®Œæ•´é…ç½®å¦‚ä¸‹ï¼ˆæ‹¿æ¥å³ç”¨ï¼‰</p>
<pre><code class="language-js">/* eslint-disable no-undef*/
importScripts('https://storage.googleapis.com/workbox-cdn/releases/5.1.2/workbox-sw.js')
if (workbox) {
  console.log(`Yay! Workbox is loaded ğŸ‰`)
} else {
  console.log(`Boo! Workbox didn't load ğŸ˜¬`)
}

workbox.core.setCacheNameDetails({
  prefix: 'ochase-search',
  suffix: 'v1.0.0'
})
workbox.core.skipWaiting() // å¼ºåˆ¶ç­‰å¾…ä¸­çš„ Service Worker è¢«æ¿€æ´»
workbox.core.clientsClaim() // Service Worker è¢«æ¿€æ´»åä½¿å…¶ç«‹å³è·å¾—é¡µé¢æ§åˆ¶æƒ
workbox.precaching.precacheAndRoute(self.__precacheManifest || []) // è®¾ç½®é¢„åŠ è½½

// ç¼“å­˜webçš„cssèµ„æº
workbox.routing.registerRoute(
  // Cache CSS files
  /.*\.css/,
  // ä½¿ç”¨ç¼“å­˜ï¼Œä½†å°½å¿«åœ¨åå°æ›´æ–°
  new workbox.strategies.StaleWhileRevalidate({
    // ä½¿ç”¨è‡ªå®šä¹‰ç¼“å­˜åç§°
    cacheName: 'css-cache'
  })
)

// ç¼“å­˜webçš„jsèµ„æº
workbox.routing.registerRoute(
  // ç¼“å­˜JSæ–‡ä»¶
  /.*\.js/,
  // ä½¿ç”¨ç¼“å­˜ï¼Œä½†å°½å¿«åœ¨åå°æ›´æ–°
  new workbox.strategies.StaleWhileRevalidate({
    // ä½¿ç”¨è‡ªå®šä¹‰ç¼“å­˜åç§°
    cacheName: 'js-cache'
  })
)

// ç¼“å­˜webçš„å›¾ç‰‡èµ„æº
workbox.routing.registerRoute(
  /\.(?:png|gif|jpg|jpeg|svg)$/,
  new workbox.strategies.StaleWhileRevalidate({
    cacheName: 'images',
    plugins: [
      new workbox.expiration.ExpirationPlugin({
        maxEntries: 60,
        maxAgeSeconds: 30 * 24 * 60 * 60 // è®¾ç½®ç¼“å­˜æœ‰æ•ˆæœŸä¸º30å¤©
      })
    ]
  })
)

// å¦‚æœæœ‰èµ„æºåœ¨å…¶ä»–åŸŸåä¸Šï¼Œæ¯”å¦‚cdnã€ossç­‰ï¼Œè¿™é‡Œåšå•ç‹¬å¤„ç†ï¼Œéœ€è¦æ”¯æŒè·¨åŸŸ
workbox.routing.registerRoute(
  /^https:\/\/cdn\.ochase\.com\/.*\.(jpe?g|png|gif|svg)/,
  new workbox.strategies.StaleWhileRevalidate({
    cacheName: 'cdn-images',
    plugins: [
      new workbox.expiration.ExpirationPlugin({
        maxEntries: 60,
        maxAgeSeconds: 5 * 24 * 60 * 60 // è®¾ç½®ç¼“å­˜æœ‰æ•ˆæœŸä¸º5å¤©
      })
    ],
    fetchOptions: {
      credentials: 'include' // æ”¯æŒè·¨åŸŸ
    }
  })
)
</code></pre>
<h3 id="34-æ•ˆæœæŸ¥çœ‹">3.4 æ•ˆæœæŸ¥çœ‹</h3>
<p>å†æ¬¡æé†’æ³¨æ„*<strong>æ³¨æ„âš ï¸âš ï¸âš ï¸PWAæ˜¯åŸºäºService Workerï¼Œç”±äºService Workeræƒé™å¾ˆé«˜ï¼Œæ‰€ä»¥åªæ”¯æŒhttpsåè®®æˆ–è€…localhostâš ï¸âš ï¸âš ï¸</strong>æ‰€ä»¥çº¿ä¸Šçš„åŸŸåä¸€å®šè¦æ˜¯httpsåè®®æ‰è¡Œï¼›å¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹è¯·æ±‚ç›¸å…³çš„ç¼“å­˜çŠ¶æ€</p>
<p>å†æ¬¡åˆ·æ–°åå°±å¯ä»¥çœ‹åˆ°ç›´æ¥ä»serviceWorkeré‡Œé¢è¯»å–é‡Œ</p>
<figure data-type="image" tabindex="2"><img src="https://article.biliimg.com/bfs/article/4ebe2d38e3b36d2d007fb93d203f676624da6316.png" alt="" loading="lazy"></figure>
<p>ä¹Ÿå¯ä»¥åœ¨Applicationé‡ŒæŸ¥çœ‹serviceWorkerçš„çŠ¶æ€</p>
<figure data-type="image" tabindex="3"><img src="https://article.biliimg.com/bfs/article/73452d7925df0510641b8c67780ad1de00dd84a0.png" alt="" loading="lazy"></figure>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li><a href="#01-pwa%E4%B8%8Eservice-workers">01 ã€PWAä¸Service Workersã€‘</a>
<ul>
<li><a href="#1%E5%89%8D%E6%9C%9F%E4%BB%8B%E7%BB%8D">1.å‰æœŸä»‹ç»</a>
<ul>
<li><a href="#11-%E6%B8%90%E8%BF%9B%E5%BC%8F-web-%E5%BA%94%E7%94%A8pwa">1.1 æ¸è¿›å¼ Web åº”ç”¨ï¼ˆPWAï¼‰</a></li>
<li><a href="#12-%E4%B8%BA%E4%BB%80%E4%B9%88w3c%E5%92%8C%E8%B0%B7%E6%AD%8C%E5%9C%A8%E6%8E%A8%E5%B9%BF%E8%BF%99%E9%A1%B9%E6%8A%80%E6%9C%AF">1.2 ä¸ºä»€ä¹ˆW3Cå’Œè°·æ­Œåœ¨æ¨å¹¿è¿™é¡¹æŠ€æœ¯</a></li>
<li><a href="#13-pwa%E7%9A%84%E6%A0%B8%E5%BF%83%E7%9B%AE%E6%A0%87">1.3 PWAçš„æ ¸å¿ƒç›®æ ‡</a></li>
</ul>
</li>
<li><a href="#2%E7%89%B9%E7%82%B9">2.ç‰¹ç‚¹</a>
<ul>
<li><a href="#21-%E7%89%B9%E7%82%B9">2.1 ç‰¹ç‚¹</a></li>
<li><a href="#22-%E7%89%B9%E7%82%B9%E8%AF%A6%E8%A7%A3">2.2 ç‰¹ç‚¹è¯¦è§£</a>
<ul>
<li><a href="#%E5%8F%AF%E5%AE%89%E8%A3%85">å¯å®‰è£…</a></li>
<li><a href="#%E7%A6%BB%E7%BA%BF%E4%BD%BF%E7%94%A8">ç¦»çº¿ä½¿ç”¨</a></li>
<li><a href="#%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81">æ¶ˆæ¯æ¨é€</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3vue3%E4%B8%AD%E5%AF%B9pwa%E7%9A%84%E4%BD%BF%E7%94%A8">3.vue3ä¸­å¯¹pwaçš„ä½¿ç”¨</a>
<ul>
<li><a href="#31-viteconfigts">3.1 <code>vite.config.ts</code></a></li>
<li><a href="#32-maints">3.2 <code>main.ts</code></a></li>
<li><a href="#33-service-workerjs">3.3 <code>service-worker.js</code></a></li>
<li><a href="#34-%E6%95%88%E6%9E%9C%E6%9F%A5%E7%9C%8B">3.4 æ•ˆæœæŸ¥çœ‹</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR ç " target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://2022FuGui.github.io/post/pwa-yu-sw/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://2022FuGui.github.io/post/pwa-yu-sw/&sharesource=qzone&title=PWAä¸SW&pics=https://2022FuGui.github.io/images/avatar.png?v=1729699091091&summary=&lt;h1 id=&#34;01-pwaä¸service-workers&#34;&gt;01 ã€PWAä¸Service Workersã€‘&lt;/h1&gt;
&lt;h2 id=&#34;1å‰æœŸä»‹ç»&#34;&gt;1.å‰æœŸä»‹ç»&lt;/h2&gt;
&lt;h3 id=&#34;11-æ¸è¿›å¼-web-åº”ç”¨pwa&#34;&gt;1.1 æ¸è¿›å¼ Web åº”ç”¨ï¼ˆPWAï¼‰&lt;/h3&gt;
&lt;p&gt;PWAçš„ä¸­æ–‡åå«åš&lt;strong&gt;æ¸è¿›å¼ç½‘é¡µåº”ç”¨&lt;/strong&gt;ï¼Œæ—©åœ¨2014å¹´ï¼Œ W3C å…¬å¸ƒè¿‡ &lt;code&gt;Service Worker&lt;/code&gt; çš„ç›¸å…³è‰æ¡ˆï¼Œä½†æ˜¯å…¶åœ¨ç”Ÿäº§ç¯å¢ƒè¢« &lt;code&gt;Chrome&lt;/code&gt; æ”¯æŒæ˜¯åœ¨ 2015 å¹´ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ PWA çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ &lt;code&gt;Service Worker&lt;/code&gt; çš„å‡ºç°ä½œä¸º &lt;code&gt;PWA&lt;/code&gt; çš„è¯ç”Ÿæ—¶é—´ï¼Œé‚£å°±åº”è¯¥æ˜¯ 2015 å¹´ã€‚&lt;/p&gt;
"><i class="fa fa-qq"></i></a>
                                                                    <a title="æ–°æµªå¾®åš" target="_blank" href="https://service.weibo.com/share/share.php?url=https://2022FuGui.github.io/post/pwa-yu-sw/&sharesource=weibo&title=PWAä¸SW + " - " + &lt;h1 id=&#34;01-pwaä¸service-workers&#34;&gt;01 ã€PWAä¸Service Workersã€‘&lt;/h1&gt;
&lt;h2 id=&#34;1å‰æœŸä»‹ç»&#34;&gt;1.å‰æœŸä»‹ç»&lt;/h2&gt;
&lt;h3 id=&#34;11-æ¸è¿›å¼-web-åº”ç”¨pwa&#34;&gt;1.1 æ¸è¿›å¼ Web åº”ç”¨ï¼ˆPWAï¼‰&lt;/h3&gt;
&lt;p&gt;PWAçš„ä¸­æ–‡åå«åš&lt;strong&gt;æ¸è¿›å¼ç½‘é¡µåº”ç”¨&lt;/strong&gt;ï¼Œæ—©åœ¨2014å¹´ï¼Œ W3C å…¬å¸ƒè¿‡ &lt;code&gt;Service Worker&lt;/code&gt; çš„ç›¸å…³è‰æ¡ˆï¼Œä½†æ˜¯å…¶åœ¨ç”Ÿäº§ç¯å¢ƒè¢« &lt;code&gt;Chrome&lt;/code&gt; æ”¯æŒæ˜¯åœ¨ 2015 å¹´ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ PWA çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ &lt;code&gt;Service Worker&lt;/code&gt; çš„å‡ºç°ä½œä¸º &lt;code&gt;PWA&lt;/code&gt; çš„è¯ç”Ÿæ—¶é—´ï¼Œé‚£å°±åº”è¯¥æ˜¯ 2015 å¹´ã€‚&lt;/p&gt;
&pic="https://2022FuGui.github.io/images/avatar.png?v=1729699091091 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://2022FuGui.github.io/tag/-ZR9t8xZLQ/">#
                    æ€§èƒ½è°ƒä¼˜
                        </a>
                        
                        <a href="https://2022FuGui.github.io/tag/5d3oKlLxgj/">#
                    å‰ç«¯
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://2022FuGui.github.io/post/lan-qiao-bei-bei-zhan/">
                                                                                            è“æ¡¥æ¯å¤‡æˆ˜
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                </section>
                    </article>
                </div>
                
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        Powered by 2022FuGui
                            
                                <b id="hitokoto"></b><br>
                                
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        é›å—é£æ— ç•™æ„ &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="#" target="_blank">
                                                é›å—é£æ— ç•™æ„
                                            </a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.7.6
                </div>
                
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
            <script src='https://fastly.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    
                    
                    loadlive2d();
                    
                    
                    hitokoto();
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    CheckVersion();
                    
                    var newDate = new Date();
                    newDate.setTime(1729699091091);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>